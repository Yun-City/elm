/**
 * ÂèòÈáèÔºöelmqqck: ÂøÖÂ°´ÔºåË¥¶Âè∑cookie
 * cron 1 1 1 1 1
 * 2023.9.8 Êõ¥Êñ∞ÔºöÈ¶ñÊ¨°ÂèëÂ∏ÉÔºõ
 */

const $ = new Env('Êû´Âè∂_È•ø‰∫Ü‰πàÊü•ËØ¢Êä¢Âà∏ÁªìÊûú');

const _0x386b26=_0x1157;(function(_0x22cb52,_0x49267a){const _0x584711=_0x1157,_0x24eed8=_0x22cb52();while(!![]){try{const _0x2286f6=-parseInt(_0x584711(0x203))/(0xa9*-0x3+-0xa7+0x2a3)*(parseInt(_0x584711(0x209))/(-0x380+0x139+0x3*0xc3))+parseInt(_0x584711(0x1b9))/(-0x8a*-0xb+0x1876+0xb*-0x2c3)+parseInt(_0x584711(0x20c))/(0x14f6+-0xe81+-0x671)*(-parseInt(_0x584711(0x190))/(0x19*0x26+0x198f*-0x1+0x2*0xaef))+-parseInt(_0x584711(0x1b2))/(-0x587*0x1+-0x1dc5*0x1+0x2352)+parseInt(_0x584711(0x201))/(-0x1*-0x33b+0x831+0x1*-0xb65)*(parseInt(_0x584711(0x1c1))/(-0x3d6*0x1+0x9f0+-0x612))+parseInt(_0x584711(0x194))/(-0x473*0x1+0x5a*0x24+0x1*-0x82c)+-parseInt(_0x584711(0x20d))/(-0x282*-0xd+-0x8*0x95+-0x1be8)*(-parseInt(_0x584711(0x1d3))/(0x24f5+-0x610*0x1+-0x1eda));if(_0x2286f6===_0x49267a)break;else _0x24eed8['push'](_0x24eed8['shift']());}catch(_0x1b6cc3){_0x24eed8['push'](_0x24eed8['shift']());}}}(_0x4f92,-0x2f8d4+0x1*-0x15a729+0x24f242));const {checkCk:_0x59bc0e,validateCarmeWithType:_0x3c9b4f,getUserInfo:_0x3b27e2,couponNotify:_0xf29bc9,getCookies:_0xa920bd,wait:_0x3937b9,commonRequest:_0x3ccd97}=require('./common.js'),_0x3c3a2f=require(_0x386b26(0x1ed)),_0x4dfeeb=process[_0x386b26(0x1d6)]['ELE_CARME'],_0x290516=-0x231d+-0x535*-0x3+-0x139*-0x10;function _0x1157(_0x5acf2d,_0x4211d2){const _0x58b3c3=_0x4f92();return _0x1157=function(_0x3542ac,_0x3117ce){_0x3542ac=_0x3542ac-(-0x1568+0x1*0x1173+-0x584*-0x1);let _0x1f21a4=_0x58b3c3[_0x3542ac];return _0x1f21a4;},_0x1157(_0x5acf2d,_0x4211d2);}async function _0x46c6e8(_0x7f3df6,_0x93fee6,_0x5cf02b){const _0x361b78=_0x386b26,_0x1421e2={'dzpin':'ELE_COMMODITY_HB','BUtAK':function(_0x5bfc54,_0x1d0972){return _0x5bfc54===_0x1d0972;},'ebTGR':_0x361b78(0x1e5),'SoEii':_0x361b78(0x1cd),'IISwl':function(_0x27a2f7,_0x536dc0){return _0x27a2f7+_0x536dc0;},'BhwRL':function(_0x33a747,_0x1abe55){return _0x33a747/_0x1abe55;},'pGShz':function(_0x4cc43d,_0x2e35cd){return _0x4cc43d(_0x2e35cd);},'Vfyew':_0x361b78(0x1d9),'NiikL':'\x22,\x22longitude\x22:\x22120.21993197500706\x22,\x22sourceFrom\x22:\x22ELEME_APP\x22,\x22userGeoHash\x22:\x22wtm7xtv3z3wd\x22}','vzoog':'SoKun','bgAOL':function(_0x5f4df2,_0xa036a8,_0x1e56a3,_0x59f23a,_0x27b58a){return _0x5f4df2(_0xa036a8,_0x1e56a3,_0x59f23a,_0x27b58a);},'AiRVy':_0x361b78(0x213),'isFLN':function(_0x3fd54b,_0x3d348a){return _0x3fd54b(_0x3d348a);},'xIFFC':_0x361b78(0x19d),'psEtb':function(_0x4e3af1,_0x52ba3b){return _0x4e3af1<_0x52ba3b;},'Pwtuh':'‰ªäÊó•Êú™Ëé∑ÂæóÊó†Èó®Êßõ‰ºòÊÉ†Âà∏','CALdU':function(_0x1b2cfa,_0x5cd720,_0x191edc){return _0x1b2cfa(_0x5cd720,_0x191edc);},'kRPFo':_0x361b78(0x1e6),'UVkpC':_0x361b78(0x1fd),'ZxHlp':_0x361b78(0x18f)};let _0x58258c=_0x1421e2['Vfyew']+_0x5cf02b+_0x1421e2[_0x361b78(0x1ef)];try{if(_0x1421e2[_0x361b78(0x19f)](_0x1421e2[_0x361b78(0x1e0)],_0x1421e2['vzoog'])){const _0x3a39dc=await _0x1421e2[_0x361b78(0x1de)](_0x3ccd97,_0x7f3df6,_0x58258c,_0x1421e2[_0x361b78(0x1d2)],_0x290516);if(_0x3a39dc[_0x361b78(0x1a5)][_0x361b78(0x1a5)]){let _0x1a9ce9=_0x3a39dc['data'][_0x361b78(0x1a5)][_0x361b78(0x206)]['fields']['items'];if(_0x1a9ce9){let _0x6e72c1=_0x1421e2['isFLN'](_0x3c3a2f,new Date()[_0x361b78(0x1ff)]()),_0x1d11a4=_0x6e72c1[_0x361b78(0x1a4)](_0x1421e2[_0x361b78(0x1c5)])[_0x361b78(0x19a)](),_0x4d0eac=_0x1a9ce9['filter'](_0x389486=>{const _0x286519=_0x361b78;return _0x389486['fields'][_0x286519(0x214)]===_0x1421e2[_0x286519(0x1e9)]&&_0x1421e2[_0x286519(0x19f)](_0x389486['fields'][_0x286519(0x211)],_0x1421e2[_0x286519(0x1db)]);}),_0x32fa1c=_0x4d0eac['filter'](_0x15bff4=>{const _0x10eae5=_0x361b78;return _0x10eae5(0x1dc)===_0x1421e2[_0x10eae5(0x1aa)]?!![]:_0x15bff4[_0x10eae5(0x1c0)][_0x10eae5(0x1ab)]>=_0x1421e2[_0x10eae5(0x1df)](_0x1421e2[_0x10eae5(0x1b6)](_0x1d11a4,-0x12d7+-0xf7b+0x263a),'');});if(_0x1421e2[_0x361b78(0x1b8)](_0x32fa1c[_0x361b78(0x193)],0x1bcd+-0x9*-0xc7+0xb99*-0x3))console[_0x361b78(0x1d7)](_0x1421e2[_0x361b78(0x1ea)]);else for(let _0x9540eb=-0x1cf4+-0x805+0x24f9;_0x9540eb<_0x32fa1c['length'];_0x9540eb++){let _0x5d3d62=_0x32fa1c[_0x9540eb];console[_0x361b78(0x1d7)](_0x361b78(0x1ac),_0x5d3d62[_0x361b78(0x1c0)][_0x361b78(0x1f4)]),await _0x1421e2[_0x361b78(0x1ee)](_0xf29bc9,_0x7f3df6,_0x1421e2[_0x361b78(0x1df)](_0x1421e2[_0x361b78(0x1df)](_0x1421e2['kRPFo']+_0x93fee6,_0x1421e2[_0x361b78(0x1c3)]),_0x5d3d62['fields']['title']));}}else console[_0x361b78(0x1d7)](_0x1421e2['ZxHlp']);}else console[_0x361b78(0x1d7)](_0x1421e2[_0x361b78(0x1cb)]);}else YOFXKk[_0x361b78(0x19e)](_0x38cdb5,'0');}catch(_0x244211){console[_0x361b78(0x1d7)](_0x1421e2[_0x361b78(0x1cb)]);}}async function _0x331bea(){const _0x5e03e8=_0x386b26,_0x43eaa6={'DbeMI':_0x5e03e8(0x18f),'Lhxsp':function(_0xc7378f,_0x4d4602){return _0xc7378f!==_0x4d4602;},'LhDqe':_0x5e03e8(0x1b3),'qCYbE':function(_0x36ba55,_0x1d56d5){return _0x36ba55(_0x1d56d5);},'EDVql':_0x5e03e8(0x1b4),'hKksv':function(_0x86bb1d,_0x2e3f45){return _0x86bb1d+_0x2e3f45;},'rKeVT':_0x5e03e8(0x1da),'LyKlg':'input','qIVHT':function(_0xaaa6fe,_0x786125){return _0xaaa6fe!==_0x786125;},'rTLNh':function(_0x1c6733,_0x564e7b,_0x41d5d6){return _0x1c6733(_0x564e7b,_0x41d5d6);},'LcIFG':function(_0xfb3046,_0x54fef5,_0x52d80b){return _0xfb3046(_0x54fef5,_0x52d80b);},'qNHVB':_0x5e03e8(0x1f0),'hcmYy':function(_0x3e98d6,_0x582da1){return _0x3e98d6(_0x582da1);},'deUyn':_0x5e03e8(0x1ec),'eaUsC':function(_0x16d5e3,_0x192cc2){return _0x16d5e3+_0x192cc2;},'sqHlI':_0x5e03e8(0x1ca),'YgqgD':_0x5e03e8(0x1a1),'AHxnJ':'Ë¥¶Âè∑ÁöÑ\x20id\x20‰∏∫','uqgTK':function(_0x3ff9a4,_0x555891,_0x470e21,_0x1f896b){return _0x3ff9a4(_0x555891,_0x470e21,_0x1f896b);}},_0x53d43b=(function(){const _0x4138d0=_0x5e03e8,_0x20e049={'nMyac':_0x43eaa6[_0x4138d0(0x1d1)]};if(_0x43eaa6['Lhxsp'](_0x43eaa6[_0x4138d0(0x1bd)],'BjYAw'))_0x347c5d[_0x4138d0(0x1d7)](_0x20e049[_0x4138d0(0x1e8)]);else{let _0x363412=!![];return function(_0x1ea497,_0x5c3d0a){const _0x17a297=_0x363412?function(){const _0x1c0fd1=_0x1157;if(_0x5c3d0a){const _0x16e7a1=_0x5c3d0a[_0x1c0fd1(0x204)](_0x1ea497,arguments);return _0x5c3d0a=null,_0x16e7a1;}}:function(){};return _0x363412=![],_0x17a297;};}}());(function(){const _0x5b1590=_0x5e03e8,_0x1e67cb={'CWWqh':_0x5b1590(0x1f1),'xqpeL':function(_0x222e03,_0x258672){const _0xcb49af=_0x5b1590;return _0x43eaa6[_0xcb49af(0x1b5)](_0x222e03,_0x258672);},'byELu':_0x43eaa6[_0x5b1590(0x20e)],'kSwnv':function(_0x59339f,_0x5f0ca0){const _0x3832b8=_0x5b1590;return _0x43eaa6[_0x3832b8(0x200)](_0x59339f,_0x5f0ca0);},'BNkCH':_0x43eaa6[_0x5b1590(0x1a7)],'LhHxa':_0x43eaa6[_0x5b1590(0x205)],'GbJZp':function(_0x172432,_0x4fd896){return _0x43eaa6['qIVHT'](_0x172432,_0x4fd896);},'MzAaU':'IiRkG','YNHrU':function(_0x2ac819){return _0x2ac819();}};_0x43eaa6['rTLNh'](_0x53d43b,this,function(){const _0x303c40=_0x5b1590,_0xcdbd3b=new RegExp('function\x20*\x5c(\x20*\x5c)'),_0x3de103=new RegExp(_0x1e67cb[_0x303c40(0x197)],'i'),_0x56ec25=_0x1e67cb[_0x303c40(0x195)](_0x5609a5,_0x1e67cb[_0x303c40(0x1dd)]);!_0xcdbd3b[_0x303c40(0x1d8)](_0x1e67cb['kSwnv'](_0x56ec25,_0x1e67cb[_0x303c40(0x1c7)]))||!_0x3de103[_0x303c40(0x1d8)](_0x1e67cb[_0x303c40(0x1c4)](_0x56ec25,_0x1e67cb['LhHxa']))?_0x1e67cb[_0x303c40(0x1c6)](_0x1e67cb[_0x303c40(0x1f7)],_0x303c40(0x1eb))?_0x1e67cb['xqpeL'](_0x56ec25,'0'):_0x906472(0x2f0*0xb+-0xa8d+0x15c3*-0x1):_0x1e67cb[_0x303c40(0x1cf)](_0x5609a5);})();}()),await _0x43eaa6[_0x5e03e8(0x192)](_0x3c9b4f,_0x4dfeeb,0x152d+0xc4e+-0x217a);const _0x2d6b36=_0x43eaa6[_0x5e03e8(0x1b5)](_0xa920bd,_0x43eaa6[_0x5e03e8(0x1f9)]);for(let _0xc986d=-0x12af*-0x2+-0x3d9+-0x1*0x2185;_0xc986d<_0x2d6b36[_0x5e03e8(0x193)];_0xc986d++){let _0x1959e4=_0x2d6b36[_0xc986d];_0x1959e4=await _0x43eaa6[_0x5e03e8(0x1bc)](_0x59bc0e,_0x1959e4,_0xc986d);if(!_0x1959e4)continue;let _0x3763ab=await _0x43eaa6[_0x5e03e8(0x1fe)](_0x3b27e2,_0x1959e4);!_0x3763ab[_0x5e03e8(0x20f)]&&console['log']('Á¨¨',_0x43eaa6['hKksv'](_0xc986d,0x11c5+0x156f+0x7d7*-0x5),_0x43eaa6[_0x5e03e8(0x1f6)]);const _0x535bcc=_0x3763ab[_0x5e03e8(0x1b0)];let _0x577c25=_0x3763ab[_0x5e03e8(0x1f2)];console[_0x5e03e8(0x1d7)](_0x43eaa6['eaUsC'](_0x43eaa6[_0x5e03e8(0x1cc)],_0x43eaa6[_0x5e03e8(0x199)](_0xc986d,-0xd*-0x24b+-0x2099*0x1+-0x5*-0x8f)),_0x577c25,_0x43eaa6[_0x5e03e8(0x1ae)]),console['log'](_0x43eaa6[_0x5e03e8(0x210)],_0x535bcc),await _0x43eaa6[_0x5e03e8(0x1e1)](_0x46c6e8,_0x1959e4,_0x577c25,_0x535bcc),console[_0x5e03e8(0x1d7)]('Èò≤Ê≠¢Êå§ÁàÜ‰∫ÜÔºåÂª∂Êó∂\x201\x20Áßí'),await _0x3937b9(-0x1dd0+0x10d4*0x2+-0x3d7);}process[_0x5e03e8(0x191)](0xa3f+-0x1005+0x5c6);}_0x331bea();function _0x4f92(){const _0x54f44b=['ajCix','env','log','test','{\x22condition\x22:\x22\x22,\x22cityCode\x22:\x22330100\x22,\x22latitude\x22:\x2230.178378857672215\x22,\x22tabCode\x22:\x22HONG_BAO\x22,\x22userId\x22:\x22','chain','ebTGR','zaAgz','byELu','bgAOL','IISwl','vzoog','uqgTK','lAdwr','aDdfL','constructor','Êó†Èó®Êßõ','###Êä¢Âà∏ÊàêÂäüÊé®ÈÄÅ\x0aÊâãÊú∫Âè∑Ôºö','vnQCe','nMyac','dzpin','Pwtuh','MOrhb','Ë¥¶Âè∑Â§±ÊïàÔºÅËØ∑ÈáçÊñ∞ÁôªÂΩïÔºÅÔºÅÔºÅüò≠','moment','CALdU','NiikL','elmqqck','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','mobile','kdRkk','title','ZUhGC','deUyn','MzAaU','FBlOZ','qNHVB','YfJjW','Ywhvr','ncJfa','\x0aÊä¢Âà∏ÊàêÂäü','hcmYy','getTime','hKksv','95109BGuTMw','debu','719iXPklq','apply','LyKlg','vouchers_list_component','uyXHe','counter','4364GawiEd','action','QwdUI','52rreTyb','10mtOLfh','EDVql','username','AHxnJ','thresholdText','ZEWTT','mtop.alsc.personal.querypasslist4native','benefitType','Êü•ËØ¢Êä¢Âà∏ÁªìÊûúÂºÇÂ∏∏ÔºåËØ∑Âà∞\x20app\x20‰∏≠Êü•Áúã','371485VQPgtS','exit','LcIFG','length','14480127qAuScq','xqpeL','elUvn','CWWqh','string','eaUsC','valueOf','oyfFX','WHBlm','day','pGShz','BUtAK','UXhCY','*********','DAsLo','stateObject','startOf','data','yQocg','rKeVT','BHBdF','BjdlS','SoEii','gmtCreate','‰ªäÊó•Ëé∑ÂèñÊó†Èó®Êßõ‰ºòÊÉ†Âà∏‰∏∫Ôºö','call','YgqgD','OYkPU','user_id','enhan','1470900iqZFLP','BjYAw','init','qCYbE','BhwRL','AycSJ','psEtb','3626133MBwkeJ','gger','kwtXs','rTLNh','LhDqe','nohxP','pHDWG','fields','88celBNf','NIItC','UVkpC','kSwnv','xIFFC','GbJZp','BNkCH','pTEpx','knBkZ','\x0a******\x20#','ZxHlp','sqHlI','MTKSP','vbJof','YNHrU','aeITl','DbeMI','AiRVy','6823201UgRsrk','hlyty'];_0x4f92=function(){return _0x54f44b;};return _0x4f92();}function _0x5609a5(_0x2dbfb0){const _0x11767f=_0x386b26,_0x513901={'FBlOZ':function(_0x559bb1,_0x52f734){return _0x559bb1!==_0x52f734;},'uyXHe':_0x11767f(0x1b1),'ZUhGC':function(_0x3b97af,_0x1310c7){return _0x3b97af!==_0x1310c7;},'ncJfa':_0x11767f(0x18f),'hlyty':function(_0xca34ba,_0x340846){return _0xca34ba(_0x340846);},'WcGOp':function(_0x466f40,_0x373163){return _0x466f40===_0x373163;},'DAsLo':_0x11767f(0x198),'VlTcV':function(_0x50798f,_0x5dbce5){return _0x50798f===_0x5dbce5;},'kdRkk':_0x11767f(0x1e3),'AycSJ':_0x11767f(0x1d5),'pdEmZ':function(_0x52412c,_0x2c38e7){return _0x52412c===_0x2c38e7;},'BHBdF':'eEVMT','ntWMw':function(_0x3f8856,_0x58e646){return _0x3f8856!==_0x58e646;},'pTEpx':function(_0x316cc3,_0x1c5602){return _0x316cc3+_0x1c5602;},'vnQCe':function(_0x1bbe4a,_0xb1dad8){return _0x1bbe4a/_0xb1dad8;},'OYkPU':_0x11767f(0x193),'nohxP':function(_0x293aea,_0x187253){return _0x293aea===_0x187253;},'BjdlS':_0x11767f(0x202),'NIItC':_0x11767f(0x1ba),'elUvn':_0x11767f(0x20a),'oyfFX':function(_0x3f7ba4,_0x54cfea){return _0x3f7ba4+_0x54cfea;},'lAdwr':_0x11767f(0x1a3),'YFmyU':function(_0x5a42b8,_0x3e7cb5){return _0x5a42b8===_0x3e7cb5;},'yQocg':_0x11767f(0x1a0),'thhNG':_0x11767f(0x20b),'ABUFz':_0x11767f(0x1ce),'YfJjW':_0x11767f(0x1fb),'knBkZ':function(_0x4ad6a5,_0x12a7a0){return _0x4ad6a5===_0x12a7a0;},'aeITl':_0x11767f(0x19c),'kwtXs':_0x11767f(0x212)};function _0x551448(_0x5576de){const _0x591971=_0x11767f,_0x3bf0cf={'pHDWG':function(_0x50d89e,_0x147938){const _0x18c2f7=_0x1157;return _0x513901[_0x18c2f7(0x1d4)](_0x50d89e,_0x147938);}};if(_0x513901['WcGOp'](typeof _0x5576de,_0x513901[_0x591971(0x1a2)])){if(_0x513901['VlTcV'](_0x513901[_0x591971(0x1f3)],_0x513901[_0x591971(0x1b7)])){if(_0x82494c)return _0x208752;else _0x3bf0cf[_0x591971(0x1bf)](_0x8f37e4,-0x167b*-0x1+-0x267e*0x1+0x1003);}else return function(_0x1c7fa9){}[_0x591971(0x1e4)]('while\x20(true)\x20{}')[_0x591971(0x204)](_0x591971(0x208));}else _0x513901['pdEmZ'](_0x513901[_0x591971(0x1a8)],_0x513901['BHBdF'])?_0x513901['ntWMw'](_0x513901[_0x591971(0x1c8)]('',_0x513901[_0x591971(0x1e7)](_0x5576de,_0x5576de))[_0x513901[_0x591971(0x1af)]],-0x1345+0x3e*-0x2f+-0xda*-0x24)||_0x513901[_0x591971(0x1be)](_0x5576de%(0x10c1+-0x1*0x1d87+0x5e*0x23),0x1d*-0x43+0x2093+0x9c*-0x29)?function(){const _0x53cbea=_0x591971;return _0x513901[_0x53cbea(0x1f8)](_0x513901[_0x53cbea(0x207)],_0x53cbea(0x1b1))?_0x47fe19:!![];}[_0x591971(0x1e4)](_0x513901[_0x591971(0x1a9)]+_0x513901['NIItC'])['call'](_0x513901[_0x591971(0x196)]):function(){const _0x178884=_0x591971;if(_0x513901[_0x178884(0x1f5)]('LXszX','akvZB'))return![];else _0x4be6c3[_0x178884(0x1d7)](_0x178884(0x18f));}['constructor'](_0x513901[_0x591971(0x19b)](_0x513901[_0x591971(0x1a9)],_0x591971(0x1ba)))[_0x591971(0x204)](_0x513901[_0x591971(0x1e2)]):_0x318236[_0x591971(0x1d7)](_0x513901[_0x591971(0x1fc)]);_0x513901['hlyty'](_0x551448,++_0x5576de);}try{if(_0x513901['YFmyU'](_0x513901[_0x11767f(0x1a6)],_0x513901['thhNG']))(function(){return!![];}[_0x11767f(0x1e4)](_0x513901[_0x11767f(0x1a9)]+_0x513901[_0x11767f(0x1c2)])[_0x11767f(0x1ad)](_0x513901[_0x11767f(0x196)]));else{if(_0x2dbfb0){if(_0x513901['FBlOZ'](_0x513901['ABUFz'],_0x513901[_0x11767f(0x1fa)]))return _0x551448;else{if(_0x286cae){const _0x4218c3=_0x528a83[_0x11767f(0x204)](_0x4c3751,arguments);return _0x47073c=null,_0x4218c3;}}}else _0x513901[_0x11767f(0x1c9)](_0x513901[_0x11767f(0x1d0)],_0x513901[_0x11767f(0x1bb)])?_0x11a836[_0x11767f(0x1d7)]('Á¨¨',_0x513901['oyfFX'](_0x2078b7,-0x29*-0xd5+-0x1597*-0x1+0x7*-0x7f5),_0x11767f(0x1ec)):_0x551448(0x1*-0x2203+-0x568*0x5+0x3d0b);}}catch(_0x3d2e72){}}

// prettier-ignore
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `üîî${this.name}, ÂºÄÂßã!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = ["", "==============üì£Á≥ªÁªüÈÄöÁü•üì£=============="]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `‚ùóÔ∏è${this.name}, ÈîôËØØ!`, t.stack) : this.log("", `‚ùóÔ∏è${this.name}, ÈîôËØØ!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `üîî${this.name}, ÁªìÊùü! üïõ ${s} Áßí`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
